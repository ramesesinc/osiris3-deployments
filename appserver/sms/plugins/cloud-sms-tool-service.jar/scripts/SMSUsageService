import com.rameses.annotations.*; 
import com.rameses.util.*;

class SMSUsageService {

	@ActiveDB('sms_usage') 
	def usage_db;

	@ProxyMethod
	public def getSummary( param ) {
		if ( !param.year ) throw new Exception('year parameter is required'); 

		if ( param.month ) {
			def buff = new StringBuilder(); 
			buff.append( param.year.toString()).append('-'); 
			buff.append( param.month.toString().padLeft(2, '0'));
			buff.append('-01'); 

			param.startdate = java.sql.Date.valueOf( buff.toString()); 
			param.enddate   = DateUtil.add( param.startdate, "1M"); 
		}
		else {
			def buff = new StringBuilder(); 
			buff.append( param.year.toString()).append('-01-01'); 
			param.startdate = java.sql.Date.valueOf( buff.toString()); 
			param.enddate   = DateUtil.add( param.startdate, "1y"); 
		}

		return usage_db.getSummary( param ); 
	}

}